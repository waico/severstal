# severstal-exhauster

В репозитории содержится исходный код построения моделей машинного обучения и прототипа системы предиктивной аналитики.

Модели машинного обучения разработаны по трем задачам:

1. Определить наличие или отсутствие неисправности М1 на заданных интервалах тестовой выборки (временные ряды сигналов на тесте имеют искусственные пропуски).
2. Определять периоды, когда были любые неисправности М3 (аномальный режим работы техместа) на протяжении всего тестового интервала.
3. Определить время до простоя М1 с максимально возможным горизонтом - для каждой точки временного ряда тестовой выборки и указать вероятное значение времени до наступления отказа оборудования.

__Результаты прогнозов на приватной выборке по всем трем задачам доступны по [ссылке](https://cloud.mail.ru/public/xNtu/Rz94iFcyd).__

## Структура Репозитория

```
.
├── README.md # Этот файл
├── app # Директория приложения визуализации и тестирования моделей
├── data # Директория для хранения данных
├── docs # Документация проекта
├── figs # Графики и изображения, используемые в проекте
├── models # Обученные модели и скрипты для их обучения
└── notebooks # Jupyter notebooks для визуализации и прототипирования
```

## Воспроизводимость построения моделей

Для повторения экспериментов по построению моделей поместите в директорию `data/raw` исходные данные:

```
data/raw
├── X_test.parquet
├── X_train.parquet
├── messages.xlsx
├── sample_submission_2.parquet
├── sample_submission_3.parquet
├── test_intervals.xlsx
└── y_train.parquet
```

### Задача 2 (Обнаружение M3)

1. Запустите файл `notebooks/Task2Step1PrepareData.ipynb` для переразметки данных. В результате создастся новый файл с разметкой M3 неисправностей - `data/processed/y_train_fixed_M3.parquet`.

2. Запустите скрипт обучения моделей - `notebooks/Task2Step2Model.py`. В нем происходит генерация признаков, разбиене выборки, обучение моделей, оценка их качества, визуализация прогнозов и сериализация моделей в директорию `models/task2`. Обученные модели доступны по [ссылке](https://cloud.mail.ru/public/viwd/7TtLJ4bcS).

3. Для получения прогнозов на приватном датасете `X_test.parquet` запустите скрипт `notebooks/Task2Step3Inference.ipynb`. В результате сформируется файл `/data/submissions/submission_2.parquet`, которыйы содержит прогноз наступления M3.